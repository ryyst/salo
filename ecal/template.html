
<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page_header }}</title>
    <style>
        html {
          font-family: Calibri, Arial, sans-serif;
          font-size: 18px;
          background-color: #f8f9fa;
          color: #212529;
          box-sizing: border-box;
        }
        body {
          margin: 0;
          padding: 1rem;
          line-height: 1.5;
        }

        .header {
          text-align: center;
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 2px solid #dee2e6;
        }

        .header h1 {
          color: #495057;
          margin: 0;
        }

        .events {
          max-width: 800px;
          margin: 0 auto;
        }

        .event {
          background: white;
          margin-bottom: 1.5rem;
          padding: 1.5rem;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          display: flex;
          gap: 1rem;
        }

        .event-title {
          font-size: 1.25rem;
          font-weight: bold;
          margin-bottom: 0.5rem;
          color: #212529;
        }

        .event-title a {
          color: #007bff;
          text-decoration: none;
        }

        .event-title a:hover {
          text-decoration: underline;
        }

        .event-dates {
          color: #6c757d;
          font-weight: 500;
          margin-bottom: 0.5rem;
        }

        .event-location {
          color: #6c757d;
          font-style: italic;
          margin-bottom: 0.5rem;
        }

        .event-excerpt {
          margin-bottom: 1rem;
        }

        .event-categories {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .category {
          background: #e9ecef;
          color: #495057;
          padding: 0.25rem 0.75rem;
          border-radius: 20px;
          font-size: 0.875rem;
        }

        .event-image {
          width: 120px;
          height: 120px;
          object-fit: cover;
          border-radius: 8px;
          flex-shrink: 0;
        }

        .event-content {
          flex: 1;
        }

        .event-placeholder {
          width: 120px;
          height: 120px;
          background: linear-gradient(135deg, #f8f9fa, #e9ecef);
          border-radius: 8px;
          flex-shrink: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #6c757d;
          font-size: 2rem;
        }

        .filters {
          display: flex;
          justify-content: center;
          gap: 0.5rem;
          margin-top: 1rem;
          flex-wrap: wrap;
        }

        .filter-btn {
          background: #e9ecef;
          border: none;
          padding: 0.5rem 1rem;
          border-radius: 20px;
          cursor: pointer;
          font-size: 0.875rem;
          transition: background-color 0.2s;
        }

        .filter-btn:hover {
          background: #dee2e6;
        }

        .filter-btn.active {
          background: #007bff;
          color: white;
        }

        .event-distance {
          color: #28a745;
          font-size: 0.8rem;
          font-weight: 500;
        }

        /* Section styling */
        .section {
          margin-bottom: 3rem;
        }

        .section-title {
          font-size: 1.5rem;
          font-weight: bold;
          color: #495057;
          padding-bottom: 1rem;
          max-width: 800px;
          margin: 0 auto;
        }

        /* Compressed ongoing event styles */
        .event.ongoing {
          padding: 1rem;
          margin-bottom: 1rem;
        }

        .event.ongoing .event-image {
          width: 60px;
          height: 60px;
        }

        .event.ongoing .event-placeholder {
          width: 60px;
          height: 60px;
          font-size: 1.5rem;
        }

        .event.ongoing .event-title {
          font-size: 1rem;
          margin-bottom: 0.25rem;
        }

        .event.ongoing .event-dates {
          font-size: 0.8rem;
          margin-bottom: 0;
        }

        .event-start-date {
          color: #adb5bd;
          font-size: 0.7rem;
          font-weight: normal;
          margin-top: 0.25rem;
        }

        /* Collapsible section styling */
        .collapsible-header {
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .collapsible-header:hover {
          color: #007bff;
        }

        .collapse-icon {
          transition: transform 0.2s ease;
          font-size: 1.2rem;
        }

        .collapse-icon.collapsed {
          transform: rotate(-90deg);
        }

        .collapsible-content {
          overflow: hidden;
          transition: max-height 0.3s ease-out;
        }

        .collapsible-content.collapsed {
          max-height: 0;
        }

        .collapsible-content.expanded {
          max-height: 10000px;
        }
    </style>
</head>
<body>
  <div class="header">
    <h1>{{ page_header }}</h1>

    <!-- Distance filters -->
    <div class="filters">
      <button class="filter-btn active" data-distance="all">Kaikki</button>
      <button class="filter-btn" data-distance="close">Keskusta (&lt;5km)</button>
      <button class="filter-btn" data-distance="nearby">L√§hist√∂ (&lt;10km)</button>
      <button class="filter-btn" data-distance="regional">Automatka (&lt;50km)</button>
    </div>
  </div>

  <!-- Ongoing long-running events section -->
  {% if data.ongoing %}
  <div class="section">
    <div class="collapsible-header section-title" onclick="toggleOngoing()">
      <span>Meneill√§√§n</span>
      <span class="collapse-icon" id="ongoing-icon">üîΩ</span>
    </div>
    <div class="collapsible-content expanded" id="ongoing-content">
      <div class="events">
        {% for event in data.ongoing %}
      <div class="event ongoing" data-distance="{{ event.distance_category }}" data-distance-km="{{ event.distance_km }}" style="border-left: 4px solid {% if 'Kulttuuri' in event.categories %}#e83e8c{% elif 'Urheilu' in event.categories %}#28a745{% elif 'Musiikki' in event.categories %}#6610f2{% elif 'Ilmainen' in event.categories %}#20c997{% else %}#6c757d{% endif %};">
        <!-- Small image or placeholder -->
        {% if event.featured_image %}
          <img src="{{ event.featured_image }}" alt="{{ event.title }}" class="event-image">
        {% else %}
          <div class="event-placeholder">üìÖ</div>
        {% endif %}

        <!-- Compressed event content -->
        <div class="event-content">
          <div class="event-title">
            {% if event.permalink %}
              <a href="{{ event.permalink }}" target="_blank">{{ event.title }}</a>
            {% else %}
              {{ event.title }}
            {% endif %}
          </div>

          <div class="event-dates">
            {{ event.days_remaining }} p√§iv√§√§ j√§ljell√§
            <span class="event-start-date">
              ({{ event.start_date_short }} - {{ event.end_date_short }})
            </span>
          </div>
        </div>
      </div>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Upcoming events section -->
  {% if data.upcoming %}
  <div class="section">
    <h2 class="section-title">Tulevat</h2>
    <div class="events">
      {% for event in data.upcoming %}
      <div class="event" data-distance="{{ event.distance_category }}" data-distance-km="{{ event.distance_km }}" style="border-left: 4px solid {% if 'Kulttuuri' in event.categories %}#e83e8c{% elif 'Urheilu' in event.categories %}#28a745{% elif 'Musiikki' in event.categories %}#6610f2{% elif 'Ilmainen' in event.categories %}#20c997{% else %}#6c757d{% endif %};">
        <!-- Image or placeholder -->
        {% if event.featured_image %}
          <img src="{{ event.featured_image }}" alt="{{ event.title }}" class="event-image">
        {% else %}
          <div class="event-placeholder">üìÖ</div>
        {% endif %}

        <!-- Full event content -->
        <div class="event-content">
          <div class="event-title">
            {% if event.permalink %}
              <a href="{{ event.permalink }}" target="_blank">{{ event.title }}</a>
            {% else %}
              {{ event.title }}
            {% endif %}
          </div>

          <div class="event-dates">
            {% if event.days_until_start == 0 %}
              Huomenna
            {% else %}
              {{ event.days_until_start }} p√§iv√§n p√§√§st√§
            {% endif %}
            <span class="event-start-date">
              {% if event.start_date_short == event.end_date_short %}
                ({{ event.start_date_short }})
              {% else %}
                ({{ event.start_date_short }} - {{ event.end_date_short }})
              {% endif %}
            </span>
          </div>

          {% if event.location %}
          <div class="event-location">üìç {{ event.location }}
            {% if event.distance_km > 0 %}
            <span class="event-distance">({{ event.distance_km }}km)</span>
            {% endif %}
          </div>
          {% endif %}

          {% if event.excerpt %}
          <div class="event-excerpt">{{ event.excerpt }}</div>
          {% endif %}

          {% if event.categories %}
          <div class="event-categories">
            {% for category in event.categories %}
            <span class="category">{{ category }}</span>
            {% endfor %}
          </div>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <script>
    // Simple accordion toggle for ongoing events
    function toggleOngoing() {
      const content = document.getElementById('ongoing-content');
      const icon = document.getElementById('ongoing-icon');

      if (content.classList.contains('collapsed')) {
        content.classList.remove('collapsed');
        content.classList.add('expanded');
        icon.classList.remove('collapsed');
        icon.textContent = 'üîΩ';
      } else {
        content.classList.remove('expanded');
        content.classList.add('collapsed');
        icon.classList.add('collapsed');
        icon.textContent = '‚ñ∂Ô∏è';
      }
    }

    // Inclusive distance filtering with minimal JavaScript
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        // Update active button
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');

        const selectedDistance = this.getAttribute('data-distance');
        const events = document.querySelectorAll('.event');

        events.forEach(event => {
          const distanceKm = parseFloat(event.getAttribute('data-distance-km')) || 0;
          let shouldShow = false;

          if (selectedDistance === 'all') {
            shouldShow = true;
          } else if (selectedDistance === 'close' && distanceKm <= 5) {
            shouldShow = true;
          } else if (selectedDistance === 'nearby' && distanceKm <= 10) {
            shouldShow = true;
          } else if (selectedDistance === 'regional' && distanceKm <= 50) {
            shouldShow = true;
          }

          event.style.display = shouldShow ? 'flex' : 'none';
        });
      });
    });
  </script>
</body>
</html>
